module test_FireWeather
  !
  ! DESCRIPTION:
  !		Test the FATES SPITFIRE model
  !
  use FatesConstantsMod, only : r8 => fates_r8
  use SFFireWeather,     only : fire_weather
  use funit

  implicit none

  ! Roundoff level tolerance
  real(r8), parameter :: tol = 1.e-15_r8

  contains 

    @Test 
    subroutine test_fire_weather()
      
      type(fire_weather) :: fireWeather ! fire weather object
      real(r8)           :: NI          ! Nesterov Index 

      ! inititalize Fire Weather class
      call fireWeather%Init(1)

      ! check that over 3 mm of rain is 0.0
      NI = fireWeather%NesterovIndex(15.0_r8, 3.1_r8, 76.0_r8)
      @assertEqual(0.0_r8, NI, tolerance=tol)

    end subroutine test_fire_weather

    
  end module test_FireWeather